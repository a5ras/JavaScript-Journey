const allButtons = document.querySelectorAll('.calculator form input[type="button"]');
const displayScreen = document.querySelector(".output");


function processInput(value) {
  if (value === "AC") {
    displayScreen.value = "";
  } 
  else if (value === "DE") {
    let currentDisplayValue = displayScreen.value;
    displayScreen.value = currentDisplayValue.slice(0, -1);
  } 
  else if (value === ".") {
    if (displayScreen.value === "") {
      displayScreen.value = "0.";
    } else {
      if (!displayScreen.value.includes(".")) {
        displayScreen.value += value;
      }
    }
  }
  else if (value === "=") {
    calculateResult();
  } 
  else {
    displayScreen.value += value;
  }
}


function calculateResult() {
  const expression = displayScreen.value;

  if (expression) {
    try {
      const result = new Function('return ' + expression)();
      displayScreen.value = result;
    } catch (error) {
      displayScreen.value = "Error";
    }
  } else {
    displayScreen.value = "";
  }
}


function handleButtonClick(event) {
  const clickedValue = event.target.value;
  processInput(clickedValue);
}

allButtons.forEach(function(button) {
  button.addEventListener('click', handleButtonClick);
});


function handleKeyDown(event) {
  const key = event.key;
  let value = null;

  if (key >= '0' && key <= '9') {
    value = key;
  } else if (key === "+" || key === "-" || key === "*" || key === "/" || key === ".") {
    value = key; 
  } else if (key === "Enter" || key === "=") {
    value = "=";
  } else if (key === "Backspace") {
    value = "DE";
  } else if (key === "A") {
    value = "AC";
  }

  if (value) {
    event.preventDefault(); 
    processInput(value);
  }
}

window.addEventListener('keydown', handleKeyDown);

